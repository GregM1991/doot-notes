<script lang="ts">
	import { Searchbar, type OnSearch } from '$lib/components/index'
	import { debounce } from '$lib/utils/misc'
	import { goto } from '$app/navigation'

	export let data

	const searchUsers = debounce(async (event: CustomEvent<OnSearch>) => {
		const data = new FormData(event.detail.form)
		const search = data.get('search')
		goto(`?search=${search}`, { replaceState: true, keepFocus: true })
	}, 400)
</script>

<h1>Doot Notes User's</h1>
<div>
	<Searchbar on:search={searchUsers} on:submit={searchUsers} />
	{#if data.status === 'error'}
		<span>{data.error}</span>
	{:else if data.users.length}
		<ul>
			{#each data.users as user}
				<li>{user.username}</li>
			{/each}
		</ul>
	{:else}Â¬
		<span>No users were found.</span>
	{/if}
</div>

<style>
	h1 {
		color: var(--palette-pop);
		font-size: var(--type-step-4);
		margin: var(--space-m)
	}
</style>